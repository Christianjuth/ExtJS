(function(){var e;e={ini:function(){return this.browser=this.getBrowser(),"undefined"==typeof localStorage.options&&"chrome"===this.browser?localStorage.options=JSON.stringify({}):void 0},getBrowser:function(){var e;return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)&&(e="chrome"),/OPR/.test(navigator.userAgent)&&/Opera Software/.test(navigator.vendor)?e="chrome":/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&(e="safari"),e},storage:{ini:function(){},set:function(e,r){return localStorage[e]=r},get:function(e){return localStorage[e]},remove:function(e){return localStorage.removeItem(e)},removeAll:function(){var r,o,t,n,i;for(n=this.dump(),i=[],o=0,t=n.length;t>o;o++)r=n[o],i.push("options"!==r?this.remove(r):void 0);return i},dump:function(){var e,r,o,t;for(e=new Array,o=0,t=localStorage.length;t>o;o++)r=localStorage[o],"options"!==localStorage.key(o)&&e.push(localStorage.key(o));return e}},options:{ini:function(){},set:function(r,o){var t;return"chrome"===e.browser&&(t=$.parseJSON(localStorage.options),t[r]=o,localStorage.options=JSON.stringify(t)),"safari"===e.browser&&(safari.extension.settings[r]=o),t[r]},get:function(r){var o,t;return"chrome"===e.browser&&(o=$.parseJSON(localStorage.options),t=o[r]),"safari"===e.browser&&(t=safari.extension.settings[r]),t},reset:function(r){var o,t;return"chrome"===e.browser&&(t=$.parseJSON(localStorage.options),$.ajax({url:"../../configure.json",dataType:"json",async:!1,success:function(e){return t[r]=_.filter(e.options,{key:r})[0]["default"],localStorage.options=JSON.stringify(t)}}),o=t[r]),"safari"===e.browser&&(o=safari.extension.settings.removeItem(r)),o},resetAll:function(){return $.ajax({url:"../../configure.json",dataType:"json",async:!1,success:function(r){var o,t,n,i,a;for(i=r.options,a=[],t=0,n=i.length;n>t;t++)o=i[t],a.push(e.options.reset(o.key));return a}}),localStorage.options}},tabs:{ini:function(){},create:function(r,o){return o!==!0?window.location.href=r:("chrome"===e.browser&&chrome.tabs.create({url:r,active:!0}),"safari"===e.browser?safari.application.activeBrowserWindow.openTab().url=r:void 0)},dump:function(r){return"chrome"===e.browser&&chrome.tabs.query({},r),"safari"===e.browser&&setTimeout(function(e){var r,o,t,n,i;for(r=[],i=safari.application.browserWindows,t=0,n=i.length;n>t;t++)o=i[t],r=r.concat(o.tabs);return e(r)},0,r),!0},indexOf:function(r,o){var t,n,i,a,s,f,c,u,l;if("chrome"===e.browser&&chrome.tabs.query({},function(t){var n,i,a,s;for(n=[],a=0,s=t.length;s>a;a++)i=t[a],e.regex.url(i.url,r)!==!1&&n.push(i);return o(n),!0}),"safari"===e.browser){for(i=[],t=[],l=safari.application.browserWindows,s=0,c=l.length;c>s;s++)a=l[s],i=i.concat(a.tabs);for(f=0,u=i.length;u>f;f++)n=i[f],"undefined"!=typeof n.url&&e.regex.url(n.url,r)!==!1&&t.push(n);o(t)}return r}},notification:function(r,o,t){return"chrome"===e.browser&&chrome.notifications.create("",{iconUrl:t,type:"basic",title:r,message:o},function(){}),"safari"===e.browser?new Notification(r,{body:o}):void 0},menu:{ini:function(){},icon:{setIcon:function(r){var o;return"chrome"===e.browser&&chrome.browserAction.setIcon({path:chrome.extension.getURL("assets/icons/"+r)}),"safari"===e.browser?(o=safari.extension.baseURI+"icons/"+r,safari.extension.toolbarItems[0].image=o):void 0},click:function(r){return"chrome"===e.browser&&chrome.browserAction.onClicked.addListener(function(){return r()}),"safari"===e.browser?safari.application.addEventListener("command",function(e){return"icon-clicked"===e.command?r():void 0},!1):void 0},setBadge:function(r){return r=parseInt(r),"chrome"===e.browser&&(0===r&&(r=""),chrome.browserAction.setBadgeText({text:String(r)})),"safari"===e.browser&&(safari.extension.toolbarItems[0].badge=r),""===r&&(r=0),r},getBadge:function(r){return"chrome"===e.browser?chrome.browserAction.getBadgeText({},r):void 0}}},regex:{url:function(e,r){return r=r.replace("*",".+"),r=new RegExp("^"+r+"$","g"),r.test(e.replace(/\/$/,""))}}},define(function(){return e}),"object"==typeof window&&"object"==typeof window.document&&(window.framework=e)}).call(this);