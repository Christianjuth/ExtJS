(function(){var a;a={browser:"",ini:function(){return this.browser=this.getBrowser(),"undefined"==typeof localStorage.options&&"chrome"===this.browser&&(localStorage.options=JSON.stringify({})),"undefined"==typeof localStorage.ext&&(localStorage.ext=JSON.stringify({})),$.each(a,function(a){var b;return"undefined"!=typeof window.ext[a]._load&&(window.ext[a]._load(),delete window.ext[a]._load),"undefined"!=typeof window.ext[a].alias&&(b=window.ext[a].alias,void 0!==typeof window.ext[b])?(window.ext[b]=window.ext[a],delete window.ext[a].alias):void 0})},getBrowser:function(){var a;return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)&&(a="chrome"),/OPR/.test(navigator.userAgent)&&/Opera Software/.test(navigator.vendor)?a="chrome":/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&(a="safari"),a},options:{set:function(b,c){var d;return"chrome"===a.browser&&(d=$.parseJSON(localStorage.options),d[b]=c,localStorage.options=JSON.stringify(d)),"safari"===a.browser&&(safari.extension.settings[b]=c),d[b]},get:function(b){var c,d;return"chrome"===a.browser&&(c=$.parseJSON(localStorage.options),d=c[b]),"safari"===a.browser&&(d=safari.extension.settings[b]),d},reset:function(b){var c,d;return"chrome"===a.browser&&(d=$.parseJSON(localStorage.options),$.ajax({url:"../../configure.json",dataType:"json",async:!1,success:function(a){return d[b]=_.filter(a.options,{key:b})[0]["default"],localStorage.options=JSON.stringify(d)}}),c=d[b]),"safari"===a.browser&&(c=safari.extension.settings.removeItem(b)),c},resetAll:function(){return $.ajax({url:"../../configure.json",dataType:"json",async:!1,success:function(b){var c,d,e,f,g;for(f=b.options,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(a.options.reset(c.key));return g}}),localStorage.options}},menu:{icon:{setIcon:function(b){var c;return"chrome"===a.browser&&chrome.browserAction.setIcon({path:chrome.extension.getURL("assets/icons/"+b)}),"safari"===a.browser?(c=safari.extension.baseURI+"icons/"+b,safari.extension.toolbarItems[0].image=c):void 0},click:function(b){return"chrome"===a.browser&&chrome.browserAction.onClicked.addListener(function(){return b()}),"safari"===a.browser?safari.application.addEventListener("command",function(a){return"icon-clicked"===a.command?b():void 0},!1):void 0},setBadge:function(b){return b=parseInt(b),"chrome"===a.browser&&(0===b&&(b=""),chrome.browserAction.setBadgeText({text:String(b)}),chrome.browserAction.setBadgeBackgroundColor({color:"#8E8E91"})),"safari"===a.browser&&(safari.extension.toolbarItems[0].badge=b),""===b&&(b=0),b},getBadge:function(b){return"chrome"===a.browser?chrome.browserAction.getBadgeText({},b):void 0}}},regex:{url:function(a,b){return b=b.replace("*",".+"),b=new RegExp("^"+b+"$","g"),b.test(a.replace(/\/$/,""))}}},window.ext=a,"function"==typeof window.define&&window.define.amd&&window.define("ext",["jquery"],function(){return window.ext})}).call(this);
