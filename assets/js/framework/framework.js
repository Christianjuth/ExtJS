(function(){var a;a={ini:function(){return this.browser=this.getBrowser(),"undefined"==typeof localStorage.options&&"chrome"===this.browser&&(localStorage.options=JSON.stringify({})),"undefined"==typeof localStorage.framework?localStorage.framework=JSON.stringify({}):void 0},getBrowser:function(){var a;return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)&&(a="chrome"),/OPR/.test(navigator.userAgent)&&/Opera Software/.test(navigator.vendor)?a="chrome":/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&(a="safari"),a},storage:{ini:function(){},set:function(a,b){return localStorage[a]=b},get:function(a){return localStorage[a]},remove:function(a){return localStorage.removeItem(a)},removeAll:function(){var a,b,c,d,e;for(d=this.dump(),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push("options"!==a?this.remove(a):void 0);return e},dump:function(){var a,b,c,d;for(a=new Array,c=0,d=localStorage.length;d>c;c++)b=localStorage[c],"options"!==localStorage.key(c)&&a.push(localStorage.key(c));return a}},options:{ini:function(){},set:function(b,c){var d;return"chrome"===a.browser&&(d=$.parseJSON(localStorage.options),d[b]=c,localStorage.options=JSON.stringify(d)),"safari"===a.browser&&(safari.extension.settings[b]=c),d[b]},get:function(b){var c,d;return"chrome"===a.browser&&(c=$.parseJSON(localStorage.options),d=c[b]),"safari"===a.browser&&(d=safari.extension.settings[b]),d},reset:function(b){var c,d;return"chrome"===a.browser&&(d=$.parseJSON(localStorage.options),$.ajax({url:"../../configure.json",dataType:"json",async:!1,success:function(a){return d[b]=_.filter(a.options,{key:b})[0]["default"],localStorage.options=JSON.stringify(d)}}),c=d[b]),"safari"===a.browser&&(c=safari.extension.settings.removeItem(b)),c},resetAll:function(){return $.ajax({url:"../../configure.json",dataType:"json",async:!1,success:function(b){var c,d,e,f,g;for(f=b.options,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(a.options.reset(c.key));return g}}),localStorage.options}},tabs:{ini:function(){},create:function(b,c){return c!==!0?window.location.href=b:("chrome"===a.browser&&chrome.tabs.create({url:b,active:!0}),"safari"===a.browser?safari.application.activeBrowserWindow.openTab().url=b:void 0)},dump:function(b){return"chrome"===a.browser&&chrome.tabs.query({},b),"safari"===a.browser&&setTimeout(function(a){var b,c,d,e,f;for(b=[],f=safari.application.browserWindows,d=0,e=f.length;e>d;d++)c=f[d],b=b.concat(c.tabs);return a(b)},0,b),!0},indexOf:function(b,c){var d,e,f,g,h,i,j,k,l;if("chrome"===a.browser&&chrome.tabs.query({},function(d){var e,f,g,h;for(e=[],g=0,h=d.length;h>g;g++)f=d[g],a.regex.url(f.url,b)!==!1&&e.push(f);return c(e),!0}),"safari"===a.browser){for(f=[],d=[],l=safari.application.browserWindows,h=0,j=l.length;j>h;h++)g=l[h],f=f.concat(g.tabs);for(i=0,k=f.length;k>i;i++)e=f[i],"undefined"!=typeof e.url&&a.regex.url(e.url,b)!==!1&&d.push(e);c(d)}return b}},notification:function(b,c,d){return"chrome"===a.browser&&chrome.notifications.create("",{iconUrl:d,type:"basic",title:b,message:c},function(){}),"safari"===a.browser?new Notification(b,{body:c}):void 0},menu:{ini:function(){},icon:{setIcon:function(b){var c;return"chrome"===a.browser&&chrome.browserAction.setIcon({path:chrome.extension.getURL("assets/icons/"+b)}),"safari"===a.browser?(c=safari.extension.baseURI+"icons/"+b,safari.extension.toolbarItems[0].image=c):void 0},click:function(b){return"chrome"===a.browser&&chrome.browserAction.onClicked.addListener(function(){return b()}),"safari"===a.browser?safari.application.addEventListener("command",function(a){return"icon-clicked"===a.command?b():void 0},!1):void 0},setBadge:function(b){return b=parseInt(b),"chrome"===a.browser&&(0===b&&(b=""),chrome.browserAction.setBadgeText({text:String(b)}),chrome.browserAction.setBadgeBackgroundColor({color:"#8E8E91"})),"safari"===a.browser&&(safari.extension.toolbarItems[0].badge=b),""===b&&(b=0),b},getBadge:function(b){return"chrome"===a.browser?chrome.browserAction.getBadgeText({},b):void 0}}},regex:{url:function(a,b){return b=b.replace("*",".+"),b=new RegExp("^"+b+"$","g"),b.test(a.replace(/\/$/,""))}}},define(function(){return a}),"object"==typeof window&&"object"==typeof window.document&&(window.framework=a)}).call(this);
